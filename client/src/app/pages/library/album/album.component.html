<ng-container>
  @if (album !== undefined) {
    <div class="flex mb-14">
      <!-- Title and metadata -->
      <div class="flex-1">
        <h1 class="text-3xl mb-10 font-semibold leading-6">{{ album.name }}</h1>
        <div class="flex text-sm">
          <div class="w-40 album-metadata text-stone-400">
            <div>Artist</div>
            @if (album.year) {
              <div>Release date</div>
            }
            @if (album.category) {
              <div>Category</div>
            }
            @if (length && length > 0) {
              <div>Length</div>
            }
            @if (trackPlays && trackPlays > 0) {
              <div>Track plays</div>
            }
            @if (albumPlays && albumPlays > 0) {
              <div>Album plays</div>
            }
            @if (tags) {
              <div>Tags</div>
            }
          </div>
          <div class="album-metadata">
            <div>
              @for (artist of album.artist; track artist; let i = $index) {
                {{ artist }}@if (i < album.artist!.length - 1) {
                <span>, </span>
              }
            }
          </div>
          @if (album.year) {
            <div>{{ album.year }}</div>
          }
          @if (album.category) {
            <div>{{ album.category }}</div>
          }
          @if (length && length > 0) {
            <div>{{ length | formatDuration }}</div>
          }
          @if (trackPlays && trackPlays > 0) {
            <div>{{ trackPlays }}</div>
          }
          @if (albumPlays && albumPlays > 0) {
            <div>{{ albumPlays }}</div>
          }
          @if (tags) {
            <div>Tags</div>
          }
        </div>
      </div>
    </div>
    @if (album.artwork && album.artwork.length > 0) {
      <div class="h-[300px] w-[300px]">
        <img [src]="cover" alt="Album cover image" (error)="setPlaceholderAlbumCover()" />
      </div>
    }
  </div>
}
<h2 class="mb-10">Tracklist</h2>
<!-- TRACKS -->
<div class="flex text-stone-400 mb-6">
  <div class="w-2/3 flex">
    <div class="mr-5 min-w-[20px] text-xs text-center">#</div>
    <div class="min-w-0 w-2/3 text-xs">Title</div>
    <div class="text-xs w-[100px]">Duration</div>
  </div>
  <div class="text-xs w-1/3">Plays</div>
</div>
<!-- <hr class="border-neutral-700 mb-4 mt-2" /> -->
<div class="flex">
  <ul class="flex-1">
    @for (track of tracks; track track; let i = $index) {
      <li class="flex items-center h-8">
        <div class="w-3/5 flex">
          <div class="mr-5 min-w-[20px] text-sm text-stone-400 text-center flex-1">{{ i + 1 }}</div>
          <div class="min-w-0 pr-5 text-sm overflow-hidden text-ellipsis whitespace-nowrap">
            {{ track.name }}
          </div>
          <div class="text-sm pr-4 w-1/3">{{ track.duration | formatDuration }}</div>
        </div>
        <div class="w-2/5 flex items-center">
          <div class="w-5/6">
            <div
              class="bar bg-teal-900 h-3 mt-[1px]"
              [style.width.%]="calculateBarWidth(tracks, track.playcount)"
            ></div>
          </div>
          <div class="text-sm text-right w-1/6">{{ track.playcount }}</div>
        </div>
      </li>
    }
  </ul>
</div>
<!-- LISTENING HISTORY -->
<div class="flex">
  <div class="w-2/3"></div>
  <div class="chart-container max-w-md h-[30rem] mb-14">
    <canvas id="albumScrobblesByYear">{{ chart }}</canvas>
  </div>
</div>
</ng-container>
